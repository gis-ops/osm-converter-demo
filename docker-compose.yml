version: '2.4'
services:
  valhalla_osm:
    image: gisops/valhalla:latest
    container_name: valhalla_osm
    ports:
      - "8000:8002"
    volumes:
      - ./data/osm/:/custom_files
    environment:
      # The tile_file must be located in the same folder as the volume mount.
      # The tile_file has priority and is used when valid.
      # If the tile_file doesn't exist, the url is used instead.
      # Don't blank out tile_url when you use tile_file and vice versa.
      - tile_urls=https://download.geofabrik.de/europe/austria-latest.osm.pbf
      # Get correct bounding box from e.g. https://boundingbox.klokantech.com/
      - min_x=15 # -> Albania | -180 -> World
      - min_y=47 # -> Albania | -90  -> World
      - max_x=17 # -> Albania |  180 -> World
      - max_y=49 # -> Albania |  90  -> World
      - use_tiles_ignore_pbf=True
      - force_rebuild=False
      - force_rebuild_elevation=False
      - build_elevation=False
      - build_admins=False
      - build_time_zones=False
  valhalla_tomtom:
    image: gisops/valhalla:latest
    container_name: valhalla_tomtom
    ports:
      - "9000:8002"
    volumes:
      - ./data/tomtom/:/custom_files
    environment:
      # The tile_file must be located in the same folder as the volume mount.
      # The tile_file has priority and is used when valid.
      # If the tile_file doesn't exist, the url is used instead.
      # Don't blank out tile_url when you use tile_file and vice versa.
      - tile_urls=https://download.geofabrik.de/europe/austria-latest.osm.pbf
      # Get correct bounding box from e.g. https://boundingbox.klokantech.com/
      - min_x=15 # -> Albania | -180 -> World
      - min_y=47 # -> Albania | -90  -> World
      - max_x=17 # -> Albania |  180 -> World
      - max_y=49 # -> Albania |  90  -> World
      - use_tiles_ignore_pbf=True
      - force_rebuild=False
      - force_rebuild_elevation=False
      - build_elevation=False
      - build_admins=False
      - build_time_zones=False
    depends_on:
      - valhalla_osm
  valhalla_here:
    image: gisops/valhalla:latest
    container_name: valhalla_here
    ports:
      - "9005:8002"
    volumes:
      - ./data/here/:/custom_files
    environment:
      # The tile_file must be located in the same folder as the volume mount.
      # The tile_file has priority and is used when valid.
      # If the tile_file doesn't exist, the url is used instead.
      # Don't blank out tile_url when you use tile_file and vice versa.
      - tile_urls=https://download.geofabrik.de/europe/austria-latest.osm.pbf
      # Get correct bounding box from e.g. https://boundingbox.klokantech.com/
      - min_x=15 # -> Albania | -180 -> World
      - min_y=47 # -> Albania | -90  -> World
      - max_x=17 # -> Albania |  180 -> World
      - max_y=49 # -> Albania |  90  -> World
      - use_tiles_ignore_pbf=True
      - force_rebuild=False
      - force_rebuild_elevation=False
      - build_elevation=False
      - build_admins=False
      - build_time_zones=False
    depends_on:
      - valhalla_osm
  converter_demo:
    image: gisops/converter-demo-app:latest
    container_name: converter-demo-app
    build:
      context: .
    ports:
      - "3000:80"
    environment:
      - VALHALLA_TOMTOM=http://localhost:9000
      - VALHALLA_OSM=http://localhost:8000
      - VALHALLA_HERE=http://localhost:9005
